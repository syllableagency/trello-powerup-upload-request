<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Power-Up Connector</title>
  </head>
  <body>
    <script src="https://p.trellocdn.com/power-up.min.js"></script>
    <script>
      const APP_KEY = "51c30a2cb14666510ff4905d9d4eae07";
      const APP_NAME = "Customer Approval Gatekeeper";
      const APP_AUTHOR = "Syllable Agency";
      const APP_VERSION = "2026-02-20-11";
      const CARD_BUTTON_ICON_URL =
        `https://syllableagency.github.io/trello-powerup-upload-request/icon-card-button.svg?v=${encodeURIComponent(APP_VERSION)}`;

      window.TrelloPowerUp.initialize(
        {
          "show-settings": function (t) {
            const settingsUrl =
              `https://syllableagency.github.io/trello-powerup-upload-request/settings.html` +
              `?v=${encodeURIComponent(APP_VERSION)}` +
              `&appKey=${encodeURIComponent(APP_KEY)}`;
            return t.modal({
              title: "Upload Request Settings",
              url: settingsUrl,
              height: 760
            });
          },
          "card-buttons": function (t) {
            return [
              {
                text: "Upload Request",
                icon: CARD_BUTTON_ICON_URL,
                callback: async function (t) {
                  const [card, board] = await Promise.all([t.card("id"), t.board("id")]);
                  const modalUrl =
                    `https://syllableagency.github.io/trello-powerup-upload-request/approval.html` +
                    `?v=${encodeURIComponent(APP_VERSION)}` +
                    `&appKey=${encodeURIComponent(APP_KEY)}`;
                  return t.modal({
                    title: "Customer Approval Verification",
                    url: modalUrl,
                    args: {
                      cardId: card?.id || "",
                      boardId: board?.id || ""
                    },
                    height: 760
                  });
                }
              }
            ];
          }
        },
        {
          appKey: APP_KEY,
          appName: APP_NAME,
          appAuthor: APP_AUTHOR
        }
      );
    </script>
  </body>
</html>
